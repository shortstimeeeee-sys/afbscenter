<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <title>ìŠ¤í¬ë¦°ìƒ· ë°œì·Œ - AFBS ì„¼í„°</title>
    <link rel="stylesheet" href="/css/common.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">âš¾ AFBS ì„¼í„°</div>
                <div class="sidebar-subtitle">ìš´ì˜ ê´€ë¦¬ ì‹œìŠ¤í…œ</div>
            </div>
            <nav class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-section-title">ì£¼ìš” ë©”ë‰´</div>
                    <a href="/" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ“Š</span><span>ëŒ€ì‹œë³´ë“œ</span></a>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">íšŒì› ê´€ë¦¬</div>
                    <a href="/members.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ‘¥</span><span>íšŒì› ê´€ë¦¬</span></a>
                    <a href="/coaches.html" class="menu-item" data-role="Manager"><span class="menu-item-icon">ğŸƒ</span><span>ì½”ì¹˜/ë ˆìŠ¨ ê´€ë¦¬</span></a>
                    <div style="margin-left: 12px; margin-top: 12px; margin-bottom: 4px; font-size: 11px; color: var(--text-secondary); font-weight: 600;">ì¶œì„ë¶€</div>
                    <a href="/attendance.html" class="menu-item" data-role="Front"><span class="menu-item-icon">âœ“</span><span>ì¶œì„/ì´ìš© ê¸°ë¡</span></a>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">ì˜ˆì•½ ê´€ë¦¬</div>
                    <a href="/bookings-without-product.html" class="menu-item" data-role="Admin"><span class="menu-item-icon">âš ï¸</span><span>ì´ìš©ê¶Œ ë¯¸ì—°ê²° ì˜ˆì•½ ê´€ë¦¬</span></a>
                    <div style="margin-left: 12px; margin-top: 8px; margin-bottom: 4px; font-size: 11px; color: var(--text-secondary); font-weight: 600;">ğŸ“ ì‚¬í•˜ì </div>
                    <a href="/bookings.html" class="menu-item" data-role="Front"><span class="menu-item-icon">âš¾</span><span>ì•¼êµ¬</span></a>
                    <a href="/bookings-saha-youth.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ‘¶</span><span>ì•¼êµ¬(ìœ ì†Œë…„)</span></a>
                    <a href="/bookings-saha-training.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ’ª</span><span>íŠ¸ë ˆì´ë‹+í•„ë¼í…ŒìŠ¤</span></a>
                    <div style="margin-left: 12px; margin-top: 12px; margin-bottom: 4px; font-size: 11px; color: var(--text-secondary); font-weight: 600;">ğŸ“ ì—°ì‚°ì </div>
                    <a href="/bookings-yeonsan.html" class="menu-item" data-role="Front"><span class="menu-item-icon">âš¾</span><span>ì•¼êµ¬</span></a>
                    <a href="/bookings-yeonsan-youth.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ‘¶</span><span>ì•¼êµ¬(ìœ ì†Œë…„)</span></a>
                    <a href="/bookings-yeonsan-training.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸ’ª</span><span>íŠ¸ë ˆì´ë‹+í•„ë¼í…ŒìŠ¤</span></a>
                    <div style="margin-left: 12px; margin-top: 12px; margin-bottom: 4px; font-size: 11px; color: var(--text-secondary); font-weight: 600;">ğŸŸï¸ ëŒ€ê´€</div>
                    <a href="/rentals.html" class="menu-item" data-role="Front"><span class="menu-item-icon">ğŸŸï¸</span><span>ëŒ€ê´€ ê´€ë¦¬</span></a>
                </div>
                <div class="menu-section">
                    <div class="menu-section-title">í›ˆë ¨ ê´€ë¦¬</div>
                    <a href="/training-logs.html" class="menu-item" data-role="Coach"><span class="menu-item-icon">ğŸ“</span><span>í›ˆë ¨ ê¸°ë¡</span></a>
                    <a href="/rankings.html" class="menu-item" data-role="Coach"><span class="menu-item-icon">ğŸ†</span><span>í›ˆë ¨ ë­í‚¹</span></a>
                    <a href="/training-stats.html" class="menu-item" data-role="Coach"><span class="menu-item-icon">ğŸ“ˆ</span><span>í›ˆë ¨ í†µê³„</span></a>
                </div>
                <div class="menu-section" data-role="Admin">
                    <div class="menu-section-title">ê´€ë¦¬ì</div>
                    <a href="/analytics.html" class="menu-item" data-role="Manager"><span class="menu-item-icon">ğŸ“ˆ</span><span>í†µê³„/ë¶„ì„</span></a>
                    <a href="/announcements.html" class="menu-item" data-role="Manager"><span class="menu-item-icon">ğŸ“¢</span><span>ê³µì§€/ë©”ì‹œì§€</span></a>
                    <a href="/screenshot-export.html" class="menu-item active" data-role="Admin"><span class="menu-item-icon">ğŸ“·</span><span>ìŠ¤í¬ë¦°ìƒ· ë°œì·Œ</span></a>
                    <a href="/users.html" class="menu-item" data-role="Admin"><span class="menu-item-icon">ğŸ‘¤</span><span>ì‚¬ìš©ì ê´€ë¦¬</span></a>
                    <a href="/permissions.html" class="menu-item" data-role="Admin"><span class="menu-item-icon">ğŸ”</span><span>ê¶Œí•œ ê´€ë¦¬</span></a>
                    <a href="/settings.html" class="menu-item" data-role="Admin"><span class="menu-item-icon">âš™ï¸</span><span>ì„¤ì •</span></a>
                </div>
            </nav>
        </aside>
        <main class="main-content">
            <header class="topbar">
                <div class="topbar-left">
                    <h1 class="page-title">ìŠ¤í¬ë¦°ìƒ· ë°œì·Œ</h1>
                </div>
                <div class="topbar-right">
                    <button class="notification-btn" id="notification-btn">ğŸ””</button>
                    <button class="user-menu-btn" id="user-menu-btn">ğŸ‘¤</button>
                </div>
            </header>
            <div class="content-area">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">ğŸ“· ìŠ¤í¬ë¦°ìƒ· ë°œì·Œ</h2>
                    </div>
                    <div class="card-body" style="padding: 24px;">
                        <p style="color: var(--text-secondary); margin-bottom: 16px;">
                            ì•„ë˜ ëª©ë¡ì—ì„œ <strong>ë¯¸ë¦¬ë³´ê¸°</strong>ë¥¼ ëˆ„ë¥´ë©´ ëª¨ë‹¬ì— í•´ë‹¹ ì˜ì—­ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. í˜ì´ì§€ë³„ë¡œ ê°™ì€ ìˆœì„œë¡œ ì •ë ¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
                        </p>
                        <div class="filter-row" style="margin-bottom: 16px; display: flex; flex-wrap: nowrap; gap: 12px; align-items: center;">
                            <label class="form-label" style="margin: 0;">í˜ì´ì§€ í•„í„°:</label>
                            <select class="form-control" id="filter-page" style="width: 220px;">
                                <option value="">ì „ì²´ í˜ì´ì§€</option>
                            </select>
                            <label class="form-label" style="margin: 0;">ê°œì¸ì •ë³´ ë³´í˜¸:</label>
                            <button type="button" class="btn btn-secondary" id="btn-mask-toggle" title="ë¯¸ë¦¬ë³´ê¸° ì‹œ ì´ë¦„(ì„±ë§Œ), íšŒì›ë²ˆí˜¸(M+***), ê¸ˆì•¡(ì›/â‚©+***) ë§ˆìŠ¤í‚¹">
                                <span id="btn-mask-label">ë³´í˜¸ ë”</span>
                            </button>
                        </div>
                        <div id="screenshot-target-list" class="table-container">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>í˜ì´ì§€</th>
                                        <th>ìº¡ì²˜ ì˜ì—­</th>
                                        <th>ì‘ì—…</th>
                                    </tr>
                                </thead>
                                <tbody id="screenshot-target-tbody">
                                </tbody>
                            </table>
                        </div>
                        <p style="margin-top: 16px; font-size: 12px; color: var(--text-muted);">
                            â€» ëª¨ë‹¬ ì•ˆ ë‚´ìš©ì„ ìŠ¤í¬ë¦°ìƒ·ìœ¼ë¡œ ì €ì¥í•˜ë ¤ë©´ ë¸Œë¼ìš°ì €ì—ì„œ í•´ë‹¹ ì˜ì—­ì„ ì§€ì •í•´ ìº¡ì²˜í•˜ê±°ë‚˜, ì¶”í›„ ì¶”ê°€ë  ã€Œìº¡ì²˜ã€ ë²„íŠ¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬: í•´ë‹¹ ì˜ì—­ë§Œ iframeìœ¼ë¡œ ë¶ˆëŸ¬ì˜´ (í™”ë©´ ì¤‘ì•™ ê³ ì •) -->
    <div id="screenshot-preview-modal" class="modal-overlay screenshot-preview-overlay" style="display: none;">
        <div class="modal screenshot-preview-modal-box">
            <div class="modal-header" style="display: flex; align-items: center; gap: 12px;">
                <h2 class="modal-title" id="screenshot-preview-modal-title" style="margin: 0;">ë¯¸ë¦¬ë³´ê¸°</h2>
                <button type="button" class="btn btn-sm btn-secondary" id="btn-mask-toggle-modal" title="ê°œì¸ì •ë³´ ë³´í˜¸: ì´ë¦„(ì„±ë§Œ), íšŒì›ë²ˆí˜¸(M+***), ê¸ˆì•¡ ë§ˆìŠ¤í‚¹">
                    <span id="btn-mask-label-modal">ì „ í˜ì´ì§€ ë³´í˜¸ ë”</span>
                </button>
                <button type="button" class="modal-close" onclick="closeScreenshotPreview()" style="margin-left: auto;">Ã—</button>
            </div>
            <div class="modal-body screenshot-preview-modal-body" style="position: relative;">
                <div id="screenshot-preview-loading" class="screenshot-preview-loading">ë¡œë”© ì¤‘...</div>
                <iframe id="screenshot-preview-iframe" class="screenshot-preview-iframe"></iframe>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeScreenshotPreview()">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
    <style>
        .screenshot-preview-overlay {
            align-items: center;
            justify-content: center;
            padding: 12px;
            box-sizing: border-box;
        }
        .screenshot-preview-modal-box .modal-header {
            background-color: var(--bg-secondary);
        }
        .screenshot-preview-modal-box {
            display: flex;
            flex-direction: column;
            width: 95vw;
            max-width: 1600px;
            height: 92vh;
            max-height: calc(100vh - 24px);
            margin: 0;
            overflow: hidden;
        }
        .screenshot-preview-modal-body {
            flex: 1;
            min-height: 0;
            padding: 0;
            padding-top: 12px;
            background-color: var(--bg-primary);
            overflow: hidden;
        }
        .screenshot-preview-iframe {
            width: 100%;
            height: 100%;
            min-height: 300px;
            border: none;
            display: block;
            background-color: var(--bg-primary);
        }
        .screenshot-preview-loading {
            position: absolute;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-size: 15px;
            z-index: 10;
        }
        .screenshot-preview-loading.hidden {
            display: none;
        }
    </style>

    <script src="/js/common.js"></script>
    <script>
        // ì‚¬ì´ë“œë°” ìˆœì„œì™€ ê° í˜ì´ì§€ ë‚´ ì„¹ì…˜ ìˆœì„œ ë™ì¼ (ëŒ€ì‹œë³´ë“œëŠ” index.html ì½˜í…ì¸  ìˆœì„œ: ê³µì§€ â†’ KPI â†’ íšŒì›ì¶”ì´ â†’ ì›”ë³„ë§¤ì¶œ â†’ ì˜¤ëŠ˜ì¼ì •)
        var SCREENSHOT_TARGETS = [
            { pageKey: 'dashboard', pageName: 'ëŒ€ì‹œë³´ë“œ', label: 'ê³µì§€ì‚¬í•­', previewUrl: '/?export=export-announcements' },
            { pageKey: 'dashboard', pageName: 'ëŒ€ì‹œë³´ë“œ', label: 'KPI ì¹´ë“œ', previewUrl: '/?export=kpi-grid' },
            { pageKey: 'dashboard', pageName: 'ëŒ€ì‹œë³´ë“œ', label: 'íšŒì› ì¦ê°€ ì¶”ì´', previewUrl: '/?export=export-member-chart' },
            { pageKey: 'dashboard', pageName: 'ëŒ€ì‹œë³´ë“œ', label: 'ì›”ë³„ ë§¤ì¶œ', previewUrl: '/?export=export-revenue-chart' },
            { pageKey: 'dashboard', pageName: 'ëŒ€ì‹œë³´ë“œ', label: 'ì˜¤ëŠ˜ ì¼ì •', previewUrl: '/?export=export-today-schedule' },
            { pageKey: 'members', pageName: 'íšŒì› ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/members.html' },
            { pageKey: 'coaches', pageName: 'ì½”ì¹˜/ë ˆìŠ¨ ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/coaches.html' },
            { pageKey: 'attendance', pageName: 'ì¶œì„/ì´ìš© ê¸°ë¡', label: 'ë³¸ë¬¸', previewUrl: '/attendance.html' },
            { pageKey: 'bookings-without-product', pageName: 'ì´ìš©ê¶Œ ë¯¸ì—°ê²° ì˜ˆì•½ ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/bookings-without-product.html' },
            { pageKey: 'bookings-saha', pageName: 'ì‚¬í•˜ì  ì•¼êµ¬', label: 'ë³¸ë¬¸', previewUrl: '/bookings.html' },
            { pageKey: 'bookings-saha-youth', pageName: 'ì‚¬í•˜ì  ì•¼êµ¬(ìœ ì†Œë…„)', label: 'ë³¸ë¬¸', previewUrl: '/bookings-saha-youth.html' },
            { pageKey: 'bookings-saha-training', pageName: 'ì‚¬í•˜ì  íŠ¸ë ˆì´ë‹+í•„ë¼í…ŒìŠ¤', label: 'ë³¸ë¬¸', previewUrl: '/bookings-saha-training.html' },
            { pageKey: 'bookings-yeonsan', pageName: 'ì—°ì‚°ì  ì•¼êµ¬', label: 'ë³¸ë¬¸', previewUrl: '/bookings-yeonsan.html' },
            { pageKey: 'bookings-yeonsan-youth', pageName: 'ì—°ì‚°ì  ì•¼êµ¬(ìœ ì†Œë…„)', label: 'ë³¸ë¬¸', previewUrl: '/bookings-yeonsan-youth.html' },
            { pageKey: 'bookings-yeonsan-training', pageName: 'ì—°ì‚°ì  íŠ¸ë ˆì´ë‹+í•„ë¼í…ŒìŠ¤', label: 'ë³¸ë¬¸', previewUrl: '/bookings-yeonsan-training.html' },
            { pageKey: 'rentals', pageName: 'ëŒ€ê´€ ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/rentals.html' },
            { pageKey: 'training-logs', pageName: 'í›ˆë ¨ ê¸°ë¡', label: 'ë³¸ë¬¸', previewUrl: '/training-logs.html' },
            { pageKey: 'rankings', pageName: 'í›ˆë ¨ ë­í‚¹', label: 'ë³¸ë¬¸', previewUrl: '/rankings.html' },
            { pageKey: 'training-stats', pageName: 'í›ˆë ¨ í†µê³„', label: 'ë³¸ë¬¸', previewUrl: '/training-stats.html' },
            { pageKey: 'products', pageName: 'ì´ìš©ê¶Œ', label: 'ë³¸ë¬¸', previewUrl: '/products.html' },
            { pageKey: 'payments', pageName: 'ê²°ì œ/ì •ì‚°', label: 'ë³¸ë¬¸', previewUrl: '/payments.html' },
            { pageKey: 'facilities', pageName: 'ì‹œì„¤ ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/facilities.html' },
            { pageKey: 'analytics', pageName: 'í†µê³„/ë¶„ì„', label: 'ë³¸ë¬¸', previewUrl: '/analytics.html' },
            { pageKey: 'announcements', pageName: 'ê³µì§€/ë©”ì‹œì§€', label: 'ë³¸ë¬¸', previewUrl: '/announcements.html' },
            { pageKey: 'users', pageName: 'ì‚¬ìš©ì ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/users.html' },
            { pageKey: 'permissions', pageName: 'ê¶Œí•œ ê´€ë¦¬', label: 'ë³¸ë¬¸', previewUrl: '/permissions.html' },
            { pageKey: 'settings', pageName: 'ì„¤ì •', label: 'ë³¸ë¬¸', previewUrl: '/settings.html' }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            if (typeof App !== 'undefined' && App.init) App.init();

            var filterSelect = document.getElementById('filter-page');
            var tbody = document.getElementById('screenshot-target-tbody');
            var pageKeys = [];
            var seen = {};
            SCREENSHOT_TARGETS.forEach(function(t) {
                if (!seen[t.pageKey]) { seen[t.pageKey] = true; pageKeys.push({ key: t.pageKey, name: t.pageName }); }
            });
            pageKeys.forEach(function(p) {
                var opt = document.createElement('option');
                opt.value = p.key;
                opt.textContent = p.name;
                filterSelect.appendChild(opt);
            });

            function renderRows(filterKey) {
                tbody.innerHTML = '';
                SCREENSHOT_TARGETS.forEach(function(t) {
                    if (filterKey && t.pageKey !== filterKey) return;
                    var tr = document.createElement('tr');
                    tr.setAttribute('data-page', t.pageKey);
                    tr.innerHTML = '<td>' + (t.pageName || '') + '</td><td>' + (t.label || '') + '</td><td><button type="button" class="btn btn-sm btn-primary btn-preview" data-preview-url="' + (t.previewUrl || '') + '" data-label="' + (t.label || 'ë¯¸ë¦¬ë³´ê¸°').replace(/"/g, '&quot;') + '">ë¯¸ë¦¬ë³´ê¸°</button></td>';
                    tbody.appendChild(tr);
                });
                tbody.querySelectorAll('.btn-preview').forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        var url = this.getAttribute('data-preview-url');
                        var label = this.getAttribute('data-label') || 'ë¯¸ë¦¬ë³´ê¸°';
                        openScreenshotPreview(url, label);
                    });
                });
            }

            renderRows('');
            filterSelect.addEventListener('change', function() {
                renderRows(this.value || '');
            });

            applyMaskToggleLabels();
            function setMaskToggle(on) {
                screenshotMaskOn = !!on;
                applyMaskToggleLabels();
                var modal = document.getElementById('screenshot-preview-modal');
                if (modal && modal.classList.contains('active') && screenshotCurrentUrl) {
                    reloadPreviewWithMask();
                }
            }
            document.getElementById('btn-mask-toggle').addEventListener('click', function() {
                setMaskToggle(!screenshotMaskOn);
            });
            document.getElementById('btn-mask-toggle-modal').addEventListener('click', function() {
                setMaskToggle(!screenshotMaskOn);
            });

            document.getElementById('screenshot-preview-modal').addEventListener('click', function(e) {
                if (e.target === this) closeScreenshotPreview();
            });
        });

        var screenshotLoadingTimeout;
        var screenshotMaskOn = false;
        var screenshotCurrentUrl = '';
        var screenshotCurrentLabel = '';
        function buildPreviewUrl(previewUrl) {
            var url = previewUrl || '';
            if (url.indexOf('export=') !== -1) {
                url = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'mask=' + (screenshotMaskOn ? '1' : '0');
            } else {
                url = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'embed=1';
                if (screenshotMaskOn) url = url + '&mask=1';
            }
            return url;
        }
        function applyMaskToggleLabels() {
            var label = document.getElementById('btn-mask-label');
            var labelModal = document.getElementById('btn-mask-label-modal');
            var t = screenshotMaskOn ? 'ë³´í˜¸ ì¼œì§' : 'ë³´í˜¸ ë”';
            if (label) label.textContent = t;
            t = screenshotMaskOn ? 'ì „ í˜ì´ì§€ ë³´í˜¸ ì¼œì§' : 'ì „ í˜ì´ì§€ ë³´í˜¸ ë”';
            if (labelModal) labelModal.textContent = t;
        }
        function openScreenshotPreview(previewUrl, label) {
            var modal = document.getElementById('screenshot-preview-modal');
            var title = document.getElementById('screenshot-preview-modal-title');
            var iframe = document.getElementById('screenshot-preview-iframe');
            var loadingEl = document.getElementById('screenshot-preview-loading');
            if (!modal || !iframe) return;
            title.textContent = label;
            screenshotCurrentUrl = previewUrl || '';
            screenshotCurrentLabel = label || 'ë¯¸ë¦¬ë³´ê¸°';
            if (loadingEl) loadingEl.classList.remove('hidden');
            iframe.src = 'about:blank';
            modal.classList.add('active');
            modal.style.display = 'flex';
            var url = buildPreviewUrl(previewUrl);
            if (screenshotLoadingTimeout) clearTimeout(screenshotLoadingTimeout);
            screenshotLoadingTimeout = setTimeout(function() {
                if (loadingEl && !loadingEl.classList.contains('hidden')) loadingEl.classList.add('hidden');
            }, 4000);
            setTimeout(function() {
                iframe.src = url || 'about:blank';
            }, 0);
        }
        function reloadPreviewWithMask() {
            var iframe = document.getElementById('screenshot-preview-iframe');
            if (!iframe || !screenshotCurrentUrl) return;
            var loadingEl = document.getElementById('screenshot-preview-loading');
            if (loadingEl) loadingEl.classList.remove('hidden');
            if (screenshotLoadingTimeout) clearTimeout(screenshotLoadingTimeout);
            screenshotLoadingTimeout = setTimeout(function() {
                if (loadingEl && !loadingEl.classList.contains('hidden')) loadingEl.classList.add('hidden');
            }, 4000);
            iframe.src = buildPreviewUrl(screenshotCurrentUrl);
        }
        function closeScreenshotPreview() {
            var modal = document.getElementById('screenshot-preview-modal');
            var iframe = document.getElementById('screenshot-preview-iframe');
            var loadingEl = document.getElementById('screenshot-preview-loading');
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
            }
            if (iframe) iframe.src = 'about:blank';
            if (loadingEl) loadingEl.classList.remove('hidden');
            if (screenshotLoadingTimeout) { clearTimeout(screenshotLoadingTimeout); screenshotLoadingTimeout = null; }
        }
        window.addEventListener('message', function(e) {
            if (e.data === 'screenshot-export-ready') {
                var loadingEl = document.getElementById('screenshot-preview-loading');
                if (loadingEl) loadingEl.classList.add('hidden');
                if (screenshotLoadingTimeout) { clearTimeout(screenshotLoadingTimeout); screenshotLoadingTimeout = null; }
            }
        });
    </script>
</body>
</html>
